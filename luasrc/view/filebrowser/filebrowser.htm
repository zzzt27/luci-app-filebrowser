<%+header%>

<div id="filebrowser-container" style="text-align: center; margin-top: 20px;">
    <!-- Pesan akan ditampilkan jika FileBrowser tidak berjalan -->
    <div id="status-message" style="color: red; font-weight: bold;"></div>
    
    <!-- Iframe akan ditampilkan jika FileBrowser berjalan -->
    <iframe id="filebrowser-iframe" src="" width="100%" height="600px" style="border: none; display: none;">
        Your browser does not support iframes.
    </iframe>
</div>

<script type="text/javascript">
    // Cek status FileBrowser
    fetch("<%=luci.dispatcher.build_url('admin/services/filebrowser/status')%>")
        .then(response => response.json())
        .then(data => {
            const iframe = document.getElementById('filebrowser-iframe');
            const message = document.getElementById('status-message');
            const url = window.location.hostname + ":<%=luci.sys.exec("uci -q get filebrowser.config.port"):gsub("^%s*(.-)%s*$", "%1")%>";

            if (data.running) {
                // Tampilkan iframe jika FileBrowser berjalan
                iframe.src = 'http://' + url;
                iframe.style.display = 'block';
                message.style.display = 'none';
            } else {
                // Tampilkan pesan jika FileBrowser tidak berjalan
                message.innerText = "FileBrowser is not running. Please enable it from the configuration page.";
                iframe.style.display = 'none';
            }
        })
        .catch(error => {
            console.error('Error fetching FileBrowser status:', error);
        });
</script>

<%+footer%>
